/*! Texttweet.js
*  Author: Michael Scharnagl @justmarkup
*  Version: 0.1.0
*  License: MIT
*/
(function(e,t){function a(e){var n=t.body,r=n.innerHTML,i=r.indexOf(e);if(i>=0){r=r.substring(0,i)+'<span id="highlight" class="highlight">'+r.substring(i,i+e.length)+"</span>"+r.substring(i+e.length);n.innerHTML=r}}var n="querySelector"in t&&"addEventListener"in e&&e.getSelection,r,i,s,o,u;if(t.location.hash){a(decodeURIComponent(t.location.hash).replace(/\+/g," ").split("#")[1]);setTimeout(function(){t.getElementById("highlight").scrollIntoView({behavior:"smooth"})},1e3)}if(n){r=function(e){return e&&(e.trim?e.trim():e.replace(/^\s+|\s+$/g,""))};i=function(e){return encodeURIComponent(r(e)).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/\./g,"%2E").replace(/~/g,"%7E").replace(/%20/g,"+")};s=function(e){return encodeURIComponent(e.replace(/\+/g,"%20").replace("#","%23"))};o=function(){var t,n,r=e.getSelection(),i=0,s=0;if(r.rangeCount){t=r.getRangeAt(0).cloneRange();if(t.getClientRects){t.collapse(true);n=t.getClientRects()[0];i=n.left;s=n.top}}return{x:i,y:s}};u=function(){var n=e.getSelection().toString(),r=t.querySelector(".share-button");if(n){if(t.querySelector(".highlight")){t.querySelector(".highlight").className=""}t.location.hash=i(n);o();r.style.top=o().y+"px";r.style.left=o().x+"px";r.className="share-button share-button-active";r.href="http://www.twitter.com/share?text="+n+"&url="+s(t.location.href)}else{r.className="share-button"}};t.documentElement.addEventListener("mousedown",function(){u()},false);t.documentElement.addEventListener("mouseup",function(){u()},false);t.documentElement.addEventListener("keydown",function(){u()},false);t.documentElement.addEventListener("keyup",function(){u()},false);e.addEventListener("scroll",function(){u()},false)}})(this,this.document)