/*! Texttweet.js
*  Author: Michael Scharnagl @justmarkup
*  Version: 0.2.0
*  License: MIT
*/
!function(a,b){"use strict";var c=function(c){
// wrap choosen text
function d(a){var c=b.body,d=c.innerHTML,e=d.indexOf(a);e>=0&&(d=d.substring(0,e)+'<span id="highlight" class="highlight">'+d.substring(e,e+a.length)+"</span>"+d.substring(e+a.length),c.innerHTML=d)}var e,f,g,h,i,j,k,l,m=c||!1,n="querySelector"in b&&"addEventListener"in a&&a.getSelection,o=!0;
// highlight text from hash and scroll it into view.
b.location.hash&&(d(decodeURIComponent(b.location.hash).replace(/\+/g," ").split("#")[1]),setTimeout(function(){b.getElementById("highlight").scrollIntoView({behavior:"smooth"})},1e3)),
// cut the mustard, the selection part only works in modern browsers
n&&(f=function(a){return a&&(a.trim?a.trim():a.replace(/^\s+|\s+$/g,""))},g=function(a){return encodeURIComponent(f(a)).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/\./g,"%2E").replace(/~/g,"%7E").replace(/%20/g,"+")},h=function(a){return encodeURIComponent(a.replace(/\+/g,"%20").replace("#","%23"))},i=function(){var b,c,d=a.getSelection(),e=0,f=0;return d.rangeCount&&(b=d.getRangeAt(0).cloneRange(),b.getClientRects&&(b.collapse(!0),c=b.getClientRects()[0],e=c.left,f=c.top)),{x:e,y:f}},k=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]==b)return!0;return!1},j=function(a,b){for(var c=document.querySelectorAll(b),d=a.parentNode;d&&!k(c,d);)d=d.parentNode;return d},l=function(){var c=a.getSelection().toString(),d=b.querySelector(".share-button");m&&c&&(e=window.getSelection().anchorNode.parentElement,o=e.className&&e.className.match(m.substring(1))?!0:null!==j(e,m)),c&&o?(b.querySelector(".highlight")&&(b.querySelector(".highlight").className=""),b.location.hash=g(c),i(),d.style.top=i().y+"px",d.style.left=i().x+"px",d.className="share-button share-button-active",d.href="http://www.twitter.com/intent/tweet?text="+c+"&url="+h(b.location.href)):d.className="share-button"},b.documentElement.addEventListener("mousedown",function(){l()},!1),b.documentElement.addEventListener("mouseup",function(){l()},!1),b.documentElement.addEventListener("keydown",function(){l()},!1),b.documentElement.addEventListener("keyup",function(){l()},!1),a.addEventListener("scroll",function(){l()},!1))};window.TextTweet=c}(this,this.document);